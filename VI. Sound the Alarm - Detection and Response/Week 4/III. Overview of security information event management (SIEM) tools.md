# Reexamine SIEM tools

- **SIEM Overview:** **[[Security Information and Event Management (SIEM)]]**. It is an application used to collect, analyze, and report on log data from various sources within an organization. SIEM tools play a critical role in monitoring and managing security-related activities.
- **SIEM Data Collection Process:** SIEM tools go through a systematic data collection process that involves the following steps:
	1. **[[Data Collection and Processing]]:** SIEM tools collect and process vast amounts of data generated by devices and systems throughout an environment. This data comes in different formats.
	2. **[[Normalization]]:** SIEM tools normalize the data, ensuring that it is consistently formatted and includes only relevant event information. Normalization simplifies data analysis.
	3. **[[Indexing]]:** The normalized data is indexed, making it easily accessible through search. This indexing allows security analysts to quickly access and analyze events from various sources.
- **SIEM Flexibility:** As a security analyst, you may encounter different SIEM tools based on your organization's preferences. It's essential to be adaptable and proficient with the specific SIEM tool your organization utilizes.
- **SIEM Platforms:** Two examples of SIEM tools were introduced:
	1. **[[Splunk]]:** Splunk is a data analysis platform that offers SIEM solutions. It collects data from multiple sources, processes and stores it in an index, and provides various methods for accessing and searching the data.
	2. **[[Chronicle]]:** Chronicle is Google Cloud's SIEM, which receives security data, normalizes it for efficient processing, and makes it accessible through a search interface.
These SIEM tools play a pivotal role in the work of a security analyst by simplifying the process of collecting, analyzing, and accessing data from various sources. They empower security analysts to efficiently monitor systems, investigate incidents, and respond to potential security threats. In the next section, you'll delve into the practical aspect of using SIEM tools by learning how to search for and analyze security data on these platforms.

# Log sources and log ingestion

In this reading, you’ll explore more on the importance of log ingestion. You may recall that **[[security information and event management (SIEM)]]** tools collect and analyze log data to monitor critical activities in an organization. You also learned about **[[log analysis]],** which is the process of examining logs to identify events of interest. Understanding how log sources are ingested into SIEM tools is important because it helps security analysts understand the types of data that are being collected, and can help analysts identify and prioritize security incidents.

## SIEM process overview

Previously, you covered the SIEM process. As a refresher, the process consists of three steps:

1. **[[Collect and aggregate data]]**: SIEM tools collect event data from various data sources.
2. **[[Normalize data]]**: Event data that's been collected becomes normalized. Normalization converts data into a standard format so that data is structured in a consistent way and becomes easier to read and search. While data normalization is a common feature in many SIEM tools, it's important to note that SIEM tools vary in their data normalization capabilities.
3. **[[Analyze data]]**: After the data is collected and normalized, SIEM tools analyze and correlate the data to identify common patterns that indicate unusual activity.

This reading focuses on the first step of this process, the collection and aggregation of data.

## Log ingestion

![[Pasted image 20231107204219.png]]

Data is required for SIEM tools to work effectively. SIEM tools must first collect data using log ingestion. **[[Log ingestion]]** is the process of collecting and importing data from log sources into a SIEM tool. Data comes from any source that generates log data, like a server.

In log ingestion, the SIEM creates a copy of the event data it receives and retains it within its own storage. This copy allows the SIEM to analyze and process the data without directly modifying the original source logs. The collection of event data provides a centralized platform for security analysts to analyze the data and respond to incidents. This event data includes authentication attempts, network activity, and more.

### Log forwarders

There are many ways SIEM tools can ingest log data. For instance, you can manually upload data or use software to help collect data for log ingestion. Manually uploading data may be inefficient and time-consuming because networks can contain thousands of systems and devices. Hence, it's easier to use software that helps collect data. 

A common way that organizations collect log data is to use log forwarders. Log forwarders are software that automate the process of collecting and sending log data. Some operating systems have native log forwarders. If you are using an operating system that does not have a native log forwarder, you would need to install a third-party log forwarding software on a device. After installing it, you'd configure the software to specify which logs to forward and where to send them. For example, you can configure the logs to be sent to a SIEM tool. The SIEM tool would then process and normalize the data. This allows the data to be easily searched, explored, correlated, and analyzed.

**Note**: Many SIEM tools utilize their own proprietary log forwarders. SIEM tools can also integrate with open-source log forwarders. Choosing the right log forwarder depends on many factors such as the specific requirements of your system or organization, compatibility with your existing infrastructure, and more. 

## Key takeaways

SIEM tools require data to be effective. As a security analyst, you will utilize SIEM tools to access events and analyze logs when you're investigating an incident. In your security career, you may even be tasked with configuring a SIEM to collect log data. It's important that you understand how data is ingested into SIEM tools because this enables you to understand where log sources come from which can help you identify the source of a security incident.

## Resources

Here are some resources if you’d like to learn more about the log ingestion process for Splunk and Chronicle:

- [Guide on getting data into Splunk](https://docs.splunk.com/Documentation/SplunkCloud/9.0.2303/Data/Howdoyouwanttoadddata)
- [Guide on data ingestion into Chronicle](https://cloud.google.com/chronicle/docs/data-ingestion-flow)

# Query for events with Splunk

- **Challenges of Searching in SIEM:** SIEM databases store vast amounts of data, including historical records that may date back years. Performing broad search queries without specific parameters can return thousands of results and slow down the search engine's response time. It's essential to make search queries as specific as possible to save time and obtain the desired results.
- **Specificity in Search Queries:** To improve search results, you should specify additional parameters such as an event ID and a date and time range. Specificity helps narrow down the search and accelerates the retrieval of relevant data. It's crucial to understand the data you're looking for and structure your query accordingly.
- **Different SIEM Search Methods:** Different SIEM tools use various search methods and query languages. For instance, Splunk utilizes its own query language called **[[Search Processing Language (SPL)]]**. SPL offers a range of search options to optimize results and retrieve the necessary data effectively.
	- **Search Example in Splunk:** An example of a raw log search in Splunk Cloud was demonstrated. The search query was designed to find events related to errors or failures in a fictional online store called Buttercup Games. The query used the index "buttercupgames" and specified search terms: "error OR fail*." The wildcard character ``"*"`` was used to account for variations in the term "fail." The search was further refined by selecting a specific time range, such as the last 30 days. The search results displayed a timeline and an events viewer, highlighting the search terms in matching events.
- **Optimizing Searches:** As a security analyst, you have the flexibility to use different commands and techniques to optimize search performance, ensuring faster and more accurate search results.

Effective querying is a fundamental skill for security analysts, enabling them to uncover security events, identify potential threats, and gain insights from SIEM databases. In the next section, you'll continue to explore how to query events, this time in Google Cloud's Chronicle.

# Query for events with Chronicle

- **[[YARA-L Language]]:** Chronicle uses the YARA-L language to define rules for event detection. YARA-L is a computer language designed for creating rules to search through ingested log data. These rules can be used to detect specific activities or behaviors, such as data exfiltration.
	- **Search Fields:** Chronicle offers various search fields to query log data, including fields like hostname, domain, IP, URL, email, username, and file hash. You can use these fields to perform different types of searches.
- **Types of search:**
	1. **[[Unified Data Model (UDM) Search]]:** The default search method in Chronicle is the UDM search, which operates on normalized data. UDM searches through the structured and formatted data, making it easier to find specific information.
		- **Example UDM Search:** An example UDM search for a failed login event was demonstrated in Chronicle. The search used structured query builder and the following query: `metadata.event_type = "USER_LOGIN" AND security_result.action = "BLOCK"`. This query is structured to search for normalized data. It specifies the event type and security action, aiming to find failed login events.
	2. **[[Raw Log Search]]:** If you can't find the data you need in normalized logs, you have the option to search raw logs. Raw logs contain unprocessed data and are used when you need to access data that hasn't been included in normalized logs or troubleshoot data ingestion issues.
- **Search Results:** The search results provide a visual representation of the data, including a timeline of events and a list of events with timestamps. Quick filters on the left allow you to further refine your search based on additional fields or values.
	- **Event Details:** Clicking on an event allows you to access the raw log associated with the event, providing more detailed information for investigation.

Performing effective searches in a SIEM tool like Chronicle is essential for security analysts to identify security events, detect anomalies, and investigate potential threats. In the upcoming activity, you'll have the opportunity to perform searches using various SIEM tools, applying the knowledge you've gained.

# Search methods with SIEM tools

So far, you’ve learned about how you can use **security information and event management (SIEM)** tools to search for security events such as failed login attempts. Remember, SIEM is an application that collects and analyzes log data to monitor critical activities in an organization. In this reading, you’ll examine how SIEM tools like Splunk and Chronicle use different search methods to find, filter, and transform search results. 

Not all organizations use the same SIEM tool to gather and centralize their security data. As a security analyst, you’ll need to be ready to learn how to use different SIEM tools. It’s important to understand the different types of searches you can perform using SIEM tools so that you can find relevant event data to support your security investigations.

## Splunk searches

As you’ve learned, Splunk has its own querying language called **Search Processing Language (SPL)**. SPL is used to search and retrieve events from indexes using Splunk’s Search & Reporting app. An SPL search can contain many different commands and arguments. For example, you can use commands to transform your search results into a chart format or filter results for specific information.